{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Head from 'next/head';\nimport RegistrationLayout from '../../components/RegistrationLayout';\nimport { Cookies } from 'react-cookie';\nimport styles from './styles.module.scss';\nimport clsx from 'clsx';\nimport InputComponent from '../../components/InputComponent';\nimport { Link } from '../../../i18n';\nimport { useRouter } from 'next/router';\nvar cookies = new Cookies();\n\nfunction Login(_ref) {\n  _objectDestructuringEmpty(_ref);\n\n  var route = useRouter();\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeItem = _React$useState2[0],\n      setActiveItem = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      login = _React$useState4[0],\n      setLogin = _React$useState4[1];\n\n  var _React$useState5 = React.useState(''),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      password = _React$useState6[0],\n      setPassword = _React$useState6[1];\n\n  var btnText = ['ЭЦП', 'Логин'];\n\n  var onSelectItem = function onSelectItem(id) {\n    setActiveItem(id);\n  };\n\n  function signIn() {\n    return _signIn.apply(this, arguments);\n  }\n\n  function _signIn() {\n    _signIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var BASE_URL, formdata, data, loginResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              BASE_URL = process.env.NEXT_PUBLIC_BASE_URL;\n              formdata = new FormData();\n              formdata.append(\"username\", login);\n              formdata.append(\"password\", password);\n              _context.next = 6;\n              return fetch(\"\".concat(BASE_URL, \"/api/login\"), {\n                method: 'POST',\n                body: formdata\n              });\n\n            case 6:\n              data = _context.sent;\n              _context.next = 9;\n              return data.json();\n\n            case 9:\n              loginResponse = _context.sent;\n\n              if (loginResponse.content !== null) {\n                cookies.set(\"token\", loginResponse.content);\n                setLogin('');\n                setPassword('');\n                route.push('/');\n              } else {\n                alert(\"Error man\");\n              }\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _signIn.apply(this, arguments);\n  }\n\n  return __jsx(RegistrationLayout, null, __jsx(Head, null, __jsx(\"title\", null, \"Tourism: Online\")), __jsx(\"div\", {\n    className: styles.login\n  }, __jsx(\"h6\", null, \"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u0443\"), __jsx(\"div\", {\n    className: styles.login_btn\n  }, btnText && btnText.map(function (el, i) {\n    return __jsx(\"button\", {\n      className: clsx(activeItem === i ? styles.login_active : ''),\n      onClick: function onClick() {\n        return activeItem !== i ? onSelectItem(i) : '';\n      },\n      key: i\n    }, el);\n  })), activeItem === 0 ? __jsx(\"div\", {\n    className: clsx(styles.login_bg, 'border-radius')\n  }, __jsx(\"div\", {\n    className: clsx(styles.login_download, 'border-radius')\n  }, __jsx(\"div\", null, __jsx(\"img\", {\n    src: \"/download.svg\",\n    alt: \"#\"\n  }), \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C\"))) : __jsx(\"div\", {\n    className: clsx(styles.login_bg, 'border-radius')\n  }, __jsx(\"form\", null, __jsx(InputComponent, {\n    type: 'text',\n    place: 'Логин',\n    value: login,\n    onChange: setLogin\n  }), __jsx(InputComponent, {\n    type: 'password',\n    place: 'Пароль',\n    value: password,\n    onChange: setPassword\n  }), __jsx(InputComponent, {\n    onClick: signIn,\n    className: 'submit',\n    type: 'button',\n    place: '',\n    value: 'Вход'\n  })), __jsx(Link, {\n    href: \"/\"\n  }, __jsx(\"a\", {\n    className: styles.login_forgot\n  }, \"\\u0417\\u0430\\u0431\\u044B\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C \\u0438\\u043B\\u0438 \\u043B\\u043E\\u0433\\u0438\\u043D?\")), __jsx(Link, {\n    href: \"/regis\"\n  }, __jsx(\"a\", {\n    className: styles.login_reg\n  }, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\")))));\n}\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}