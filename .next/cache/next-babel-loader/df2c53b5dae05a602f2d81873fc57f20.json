{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\meehr\\\\Desktop\\\\front\\\\tourism-online\\\\src\\\\pages\\\\login\\\\index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Head from 'next/head';\nimport RegistrationLayout from '../../components/RegistrationLayout';\nimport { parseCookies, setCookie, destroyCookie } from 'nookies';\nimport styles from './styles.module.scss';\nimport clsx from 'clsx';\nimport InputComponent from '../../components/InputComponent';\nimport Link from 'next/link';\n\nfunction Login(_ref) {\n  _s();\n\n  var _this = this;\n\n  var cookies = _ref.cookies;\n  console.log(\"Login -> cookies\", cookies);\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeItem = _React$useState2[0],\n      setActiveItem = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      login = _React$useState4[0],\n      setLogin = _React$useState4[1];\n\n  var _React$useState5 = React.useState(''),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      password = _React$useState6[0],\n      setPassword = _React$useState6[1];\n\n  var btnText = ['ЭЦП', 'Логин'];\n\n  var onSelectItem = function onSelectItem(id) {\n    setActiveItem(id);\n  };\n\n  function signIn() {\n    return _signIn.apply(this, arguments);\n  }\n\n  function _signIn() {\n    _signIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var formdata, data, loginResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              formdata = new FormData();\n              formdata.append(\"username\", login);\n              formdata.append(\"password\", password);\n              _context.next = 5;\n              return fetch(\"http://127.0.0.1:8000/api/login\", {\n                method: 'POST',\n                body: formdata\n              });\n\n            case 5:\n              data = _context.sent;\n              _context.next = 8;\n              return data.json();\n\n            case 8:\n              loginResponse = _context.sent;\n              localStorage.setItem(\"token\", loginResponse.content);\n\n              if (localStorage.getItem(\"token\") !== null) {\n                setLogin('');\n                setPassword('');\n              }\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _signIn.apply(this, arguments);\n  }\n\n  return __jsx(RegistrationLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, \"Tourism: Online\")), __jsx(\"div\", {\n    className: styles.login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, __jsx(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, \"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u0443\"), __jsx(\"div\", {\n    className: styles.login_btn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, btnText && btnText.map(function (el, i) {\n    return __jsx(\"button\", {\n      className: clsx(activeItem === i ? styles.login_active : ''),\n      onClick: function onClick() {\n        return activeItem !== i ? onSelectItem(i) : '';\n      },\n      key: i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }\n    }, el);\n  })), activeItem === 0 ? __jsx(\"div\", {\n    className: clsx(styles.login_bg, 'border-radius'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: clsx(styles.login_download, 'border-radius'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 17\n    }\n  }, __jsx(\"img\", {\n    src: \"/download.svg\",\n    alt: \"#\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 19\n    }\n  }), \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C\"))) : __jsx(\"div\", {\n    className: clsx(styles.login_bg, 'border-radius'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, __jsx(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 15\n    }\n  }, __jsx(InputComponent, {\n    type: 'text',\n    place: 'Логин',\n    value: login,\n    onChange: setLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 17\n    }\n  }), __jsx(InputComponent, {\n    type: 'password',\n    place: 'Пароль',\n    value: password,\n    onChange: setPassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }), __jsx(InputComponent, {\n    onClick: signIn,\n    className: 'submit',\n    type: 'button',\n    place: '',\n    value: 'Вход',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  })), __jsx(Link, {\n    href: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 15\n    }\n  }, __jsx(\"a\", {\n    className: styles.login_forgot,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }, \"\\u0417\\u0430\\u0431\\u044B\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C \\u0438\\u043B\\u0438 \\u043B\\u043E\\u0433\\u0438\\u043D?\")), __jsx(Link, {\n    href: \"/regis\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }\n  }, __jsx(\"a\", {\n    className: styles.login_reg,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\")))));\n}\n\n_s(Login, \"QG4ic/S5aCfA6W6zaCbt2MzK7dE=\");\n\n_c = Login;\nexport var __N_SSP = true;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Users/meehr/Desktop/front/tourism-online/src/pages/login/index.js"],"names":["React","Head","RegistrationLayout","parseCookies","setCookie","destroyCookie","styles","clsx","InputComponent","Link","Login","cookies","console","log","useState","activeItem","setActiveItem","login","setLogin","password","setPassword","btnText","onSelectItem","id","signIn","formdata","FormData","append","fetch","method","body","data","json","loginResponse","localStorage","setItem","content","getItem","login_btn","map","el","i","login_active","login_bg","login_download","login_forgot","login_reg"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Head from 'next/head'\r\nimport RegistrationLayout from '../../components/RegistrationLayout'\r\nimport nookies, { parseCookies, setCookie, destroyCookie } from 'nookies'\r\n\r\n\r\nimport styles from './styles.module.scss'\r\nimport clsx from 'clsx'\r\nimport InputComponent from '../../components/InputComponent'\r\nimport Link from 'next/link'\r\n\r\nfunction Login({cookies}) {\r\nconsole.log(\"Login -> cookies\", cookies)\r\n\r\n  const [activeItem, setActiveItem] = React.useState(0);\r\n  const [login, setLogin] = React.useState('');\r\n  const [password, setPassword] = React.useState('');\r\n\r\n  const btnText = ['ЭЦП', 'Логин']\r\n\r\n  const onSelectItem = id => {\r\n    setActiveItem(id)\r\n  }\r\n\r\n\r\n  async function signIn() {\r\n\r\n    const formdata = new FormData();\r\n    formdata.append(\"username\", login);\r\n    formdata.append(\"password\", password);\r\n  \r\n    const data = await fetch(\"http://127.0.0.1:8000/api/login\", {\r\n      method: 'POST',\r\n      body: formdata\r\n    })\r\n  \r\n    const loginResponse = await data.json()\r\n    localStorage.setItem(\"token\", loginResponse.content)\r\n    \r\n\r\n    if(localStorage.getItem(\"token\") !== null) {\r\n      setLogin('')\r\n      setPassword('')\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <RegistrationLayout>\r\n      <Head>\r\n        <title>Tourism: Online</title>\r\n      </Head>\r\n      <div className={styles.login}>\r\n        <h6>Вход в систему</h6>\r\n        <div className={styles.login_btn}>\r\n          {\r\n            btnText && (\r\n              btnText.map((el,i) => (\r\n                <button  \r\n                  className={clsx(activeItem === i ? styles.login_active : '')}\r\n                  onClick={() => activeItem !== i ? onSelectItem(i) : ''}\r\n                  key={i}\r\n                >\r\n                  {el}\r\n                </button>\r\n              ))\r\n            )\r\n          }\r\n        </div>\r\n        {\r\n          activeItem === 0 \r\n          ? \r\n          (\r\n            <div className={clsx(styles.login_bg, 'border-radius')}>\r\n              <div className={clsx(styles.login_download, 'border-radius')}>\r\n                <div>\r\n                  <img src=\"/download.svg\" alt=\"#\"/>\r\n                  Загрузить\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) \r\n          : \r\n          (\r\n            <div className={clsx(styles.login_bg, 'border-radius')}>\r\n              <form>\r\n                <InputComponent type={'text'} place={'Логин'} value={login} onChange={setLogin}  />\r\n                <InputComponent type={'password'} place={'Пароль'} value={password} onChange={setPassword}  />\r\n                <InputComponent onClick={signIn} className={'submit'} type={'button'} place={''} value={'Вход'}  />\r\n              </form>\r\n              <Link href=\"/\">\r\n                <a className={styles.login_forgot}>Забыли пароль или логин?</a>\r\n              </Link>\r\n              <Link href=\"/regis\">\r\n                <a className={styles.login_reg}>Регистрация</a>\r\n              </Link>\r\n            </div>\r\n          )\r\n        }\r\n      </div>\r\n    </RegistrationLayout>\r\n  )\r\n}\r\n\r\nexport async function getServerSideProps(ctx) {\r\n  // Parse\r\n  const cookies = nookies.get(ctx)\r\n\r\n  \r\n\r\n  return { cookies }\r\n}\r\n\r\nexport default Login"]},"metadata":{},"sourceType":"module"}